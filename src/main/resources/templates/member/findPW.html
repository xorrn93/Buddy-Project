<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</title>
    <script
            src="https://code.jquery.com/jquery-3.6.1.min.js"
            integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
            crossorigin="anonymous"
    ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<body>

<h1>ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠì–´ ë²„ë¦¬ì…¨ë‚˜ìš”?ğŸ˜¥</h1>
<form action="/email/sendPW" id="sendEmail">
  <input type="text" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" id="inputEmail" name="memberEmail">
   <button id="submitBtn" type="button">ì „ì†¡</button>
</form>
<script>
    document.querySelector('#submitBtn').addEventListener('click',function (){
        let userEmail = document.querySelector('#inputEmail').value;
        let sendEmail = document.querySelector('#sendEamil');
        const emailRegex = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
        if (emailRegex.test(userEmail)){
            $.ajax({
                url: "/member/idCheck",
                data: {
                    "id" : userEmail
                },error: function (){
                    alert('error!');
                }
            }).done( function(rsp){
                if (rsp === 'true'){
                    sendEmail.submit();
                    alert(`${userEmail} ë¡œ ì„ì‹œë¹„ë°€ë²ˆí˜¸ë¥¼ ë³´ë‚´ë“œë ·ìŠµë‹ˆë‹¤!`);
                }else {
                    alert("í•´ë‹¹ ì´ë©”ì¼ì˜ íšŒì›ì •ë³´ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                }
            })
        }else {
            alert("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ë°©ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
        }
    })


</script>
</body>
</html>